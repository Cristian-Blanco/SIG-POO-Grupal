<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Movilidad en el Barrio Potos√≠</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <!-- Estilos personalizados -->
  <link rel="stylesheet" href="estilosM.css" />
</head>
<body>
  <!-- Secci√≥n del mapa -->
  <section class="seccion-movilidad">
    <h2>Movilidad en el Barrio Potos√≠, Suba</h2>
    <div class="map-container">
      <div id="map"></div>
    </div>
  </section>

  <!-- Secci√≥n del tutorial -->
  <section class="seccion-tutorial">
    <h2>¬øC√≥mo se construy√≥ este mapa interactivo?</h2>
    <p>Este mapa fue desarrollado utilizando tecnolog√≠as web modernas, siguiendo buenas pr√°cticas de desarrollo cartogr√°fico. A continuaci√≥n, te explicamos paso a paso c√≥mo se hizo, con detalles t√©cnicos y conceptos clave.</p>

    <ol class="tutorial-list">
      <li>
        <strong>1. Descarga de los datos geoespaciales en formato GeoJSON</strong>
        <p>El proyecto comienza con dos archivos clave en formato <strong>GeoJSON</strong>, el est√°ndar abierto para datos geogr√°ficos:</p>
        <ul>
          <li><strong><code>potosi.geojson</code></strong>: Define el pol√≠gono del barrio Potos√≠ en Suba. Este archivo contiene un <code>Polygon</code> o <code>MultiPolygon</code> con coordenadas en <strong>WGS 84 (EPSG:4326)</strong>, el sistema de referencia global que usan Leaflet y OpenStreetMap.</li>
          <li><strong><code>Paraderos_Zonales_del_SITP.geojson</code></strong>: Contiene miles de puntos (<code>Point</code>) que representan los paraderos del SITP en Bogot√°. Se descarg√≥ desde la plataforma oficial: <a href="https://datosabiertos-transmilenio.hub.arcgis.com/datasets/paraderos-zonales-del-sitp/explore" target="_blank">ArcGIS Open Data - TransMilenio</a>.</li>
        </ul>
        <p>‚úÖ Ambos archivos deben estar en la misma carpeta que el proyecto para que <code>fetch()</code> los cargue correctamente.</p>
      </li>

      <li>
        <strong>2. Inicializaci√≥n del mapa con Leaflet</strong>
        <p>Se us√≥ <a href="https://leafletjs.com" target="_blank">Leaflet</a>, la biblioteca JavaScript l√≠der para mapas interactivos, por su simplicidad, rendimiento y compatibilidad con m√≥viles.</p>
        <p>El mapa se inicializa en un elemento HTML con <code>id="map"</code> y se centra en el barrio Potos√≠:</p>
        <pre><code>var map = L.map('map').setView([4.653, -74.085], 14);</code></pre>
        <p>El nivel de zoom <code>14</code> permite ver detalles urbanos como calles y paraderos.</p>
      </li>

      <li>
        <strong>3. Carga de la capa base: OpenStreetMap</strong>
        <p>Leaflet no incluye mapas por defecto. Se a√±ade una capa de teselas (tiles) de <strong>OpenStreetMap</strong>, un mapa base gratuito y de c√≥digo abierto:</p>
        <pre><code>L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);</code></pre>
        <p>Esta capa proporciona el fondo del mapa y es esencial para contextualizar los datos.</p>
      </li>

      <li>
        <strong>4. Dibujar el pol√≠gono del barrio</strong>
        <p>Con <code>fetch()</code>, se carga <code>potosi.geojson</code> y se agrega al mapa como una capa vectorial:</p>
        <pre><code>L.geoJSON(data, {
  style: estiloBarrio,
  onEachFeature: function (feature, layer) {
    layer.bindPopup('<b>Barrio Potos√≠</b><br>Localidad: Suba');
  }
}).addTo(map);</code></pre>
        <p>El estilo define el color naranja del borde y relleno. <code>onEachFeature</code> permite agregar popups a cada elemento.</p>
      </li>

      <li>
        <strong>5. Filtrar paraderos dentro del barrio con Turf.js</strong>
        <p>Leaflet no puede verificar si un punto est√° dentro de un pol√≠gono. Para eso, se usa <a href="https://turfjs.org" target="_blank">Turf.js</a>, una librer√≠a geoespacial potente.</p>
        <p>El c√≥digo convierte el GeoJSON del barrio a un pol√≠gono con <code>turf.polygon()</code> y verifica cada paradero:</p>
        <pre><code>if (turf.booleanPointInPolygon(punto, barrioPolygon)) {
  // Mostrar solo si est√° dentro
}</code></pre>
        <p>Este filtro asegura que solo se muestren los paraderos relevantes.</p>
      </li>

      <li>
        <strong>6. Agregar marcadores interactivos</strong>
        <p>Cada paradero se representa con un marcador usando el emoji üöå, creado con <code>L.divIcon()</code>:</p>
        <pre><code>const iconoParadero = L.divIcon({
  html: 'üöå',
  className: 'paradero-icon',
  iconSize: [30, 30]
});</code></pre>
        <p>Al hacer clic, se abre un popup con informaci√≥n √∫til: nombre, direcci√≥n bandera, c√≥digo cenefa y localidad.</p>
      </li>

      <li>
        <strong>7. Dise√±o y experiencia de usuario</strong>
        <p>El mapa es <strong>mobile-friendly</strong>, con controles t√°ctiles como:</p>
        <ul>
          <li>Arrastre con inercia</li>
          <li>Pinzamiento para zoom</li>
          <li>Desplazamiento con rueda del mouse</li>
        </ul>
        <p>Los estilos CSS personalizados mejoran la presentaci√≥n, y los popups se adaptan a cualquier dispositivo.</p>
      </li>

      <li>
        <strong>8. Ejecuci√≥n local con Live Server</strong>
        <p>Para evitar errores de <em>CORS</em> al cargar archivos locales, se usa un servidor local como <strong>Live Server</strong> (extensi√≥n de VS Code).</p>
        <p>La URL debe ser <code>http://localhost:5500</code>, no <code>file://</code>.</p>
      </li>
    </ol>

    <h3>¬øPor qu√© Leaflet?</h3>
    <p>Leaflet fue elegido porque:</p>
    <ul>
      <li>Es <strong>ligero</strong> (~42 KB) y sin dependencias externas.</li>
      <li>Tiene una <strong>API clara y bien documentada</strong>.</li>
      <li>Soporta <strong>GeoJSON, capas vectoriales y controles personalizados</strong>.</li>
      <li>Es compatible con <strong>m√≥viles y escritorio</strong>.</li>
      <li>Tiene miles de <strong>plugins</strong> para extender funcionalidades.</li>
    </ul>
  </section>

  <!-- Secci√≥n de definiciones avanzadas -->
<section class="seccion-definiciones">
  <h2>Definiciones t√©cnicas basadas en Leaflet.js</h2>
  <p>Esta secci√≥n se basa en la documentaci√≥n oficial de <a href="https://leafletjs.com" target="_blank">Leaflet</a>, la biblioteca l√≠der para mapas interactivos.</p>

  <h3>¬øQu√© es Leaflet?</h3>
  <p><strong>Leaflet</strong> es la biblioteca JavaScript l√≠der para crear <strong>mapas interactivos m√≥viles y de escritorio</strong>. Con solo <strong>42 KB</strong>, incluye todas las funciones que la mayor√≠a de desarrolladores necesitan.</p>
  <p>Est√° dise√±ado con <strong>simplicidad, rendimiento y usabilidad</strong> en mente, y funciona eficientemente en todos los dispositivos principales.</p>

  <h3>Caracter√≠sticas principales de Leaflet</h3>

  <h4>1. Capas por defecto (Layers Out of the Box)</h4>
  <p>Leaflet incluye soporte nativo para varios tipos de capas:</p>
  <ul>
    <li><strong>Tile layers:</strong> Im√°genes de fondo del mapa (como OpenStreetMap).</li>
    <li><strong>WMS:</strong> Servicios de mapas web est√°ndar (usados en GIS).</li>
    <li><strong>Markers:</strong> Marcadores que se√±alan ubicaciones.</li>
    <li><strong>Popups:</strong> Ventanas emergentes con informaci√≥n.</li>
    <li><strong>Vector layers:</strong> L√≠neas, pol√≠gonos, c√≠rculos y rect√°ngulos dibujados en el mapa.</li>
    <li><strong>GeoJSON:</strong> Soporte integrado para cargar y mostrar datos geoespaciales.</li>
    <li><strong>Image overlays:</strong> Im√°genes superpuestas en coordenadas geogr√°ficas.</li>
  </ul>

  <h4>2. Interacci√≥n (Interaction Features)</h4>
  <p>Leaflet ofrece una experiencia de usuario fluida y natural:</p>
  <ul>
    <li><strong>Arrastre con inercia:</strong> El mapa sigue movi√©ndose despu√©s de soltar el mouse.</li>
    <li><strong>Zoom con rueda:</strong> Aumenta o disminuye el nivel de detalle.</li>
    <li><strong>Pinch-zoom en m√≥viles:</strong> Usa dos dedos para hacer zoom.</li>
    <li><strong>Doble clic para acercar:</strong> Alternativa r√°pida al zoom.</li>
    <li><strong>Zoom a √°rea (Shift + arrastrar):</strong> Selecciona un rect√°ngulo para acercar.</li>
    <li><strong>Navegaci√≥n con teclado:</strong> Mover el mapa con flechas.</li>
    <li><strong>Eventos:</strong> Detecta clics, pasar el mouse, arrastrar marcadores, etc.</li>
    <li><strong>Arrastre de marcadores:</strong> Para reubicarlos (√∫til en formularios).</li>
  </ul>

  <h4>3. Caracter√≠sticas visuales (Visual Features)</h4>
  <p>Leaflet no solo funciona bien, sino que se ve bien:</p>
  <ul>
    <li><strong>Animaciones de zoom y desplazamiento:</strong> Suaves y naturales.</li>
    <li><strong>Fade en popups y teselas:</strong> Transiciones elegantes.</li>
    <li><strong>Dise√±o predeterminado atractivo:</strong> Marcadores, controles y popups bien dise√±ados.</li>
    <li><strong>Soporte para pantallas retina:</strong> Im√°genes n√≠tidas en dispositivos de alta resoluci√≥n.</li>
  </ul>

  <h4>4. Personalizaci√≥n (Customization Features)</h4>
  <p>Leaflet es altamente personalizable:</p>
  <ul>
    <li><strong>Popups y controles con CSS:</strong> F√°ciles de restilar.</li>
    <li><strong>Marcadores con imagen o HTML:</strong> Puedes usar emojis, √≠conos o texto.</li>
    <li><strong>Capas y controles personalizados:</strong> Crea tus propias funciones.</li>
    <li><strong>Proyecciones de mapa:</strong> Soporta EPSG:3857 (Web Mercator), EPSG:4326 (WGS 84) y EPSG:3395.</li>
    <li><strong>Extensi√≥n de clases:</strong> Programaci√≥n orientada a objetos para crear funcionalidades nuevas.</li>
  </ul>

  <h4>5. Rendimiento (Performance Features)</h4>
  <p>Leaflet est√° optimizado para ser r√°pido y eficiente:</p>
  <ul>
    <li><strong>Aceleraci√≥n por hardware en m√≥viles:</strong> Se siente como una app nativa.</li>
    <li><strong>Uso de CSS para animaciones:</strong> Panning y zoom muy suaves.</li>
    <li><strong>Renderizado inteligente de l√≠neas y pol√≠gonos:</strong> Simplificaci√≥n din√°mica para mejorar el rendimiento.</li>
    <li><strong>Sistema modular:</strong> Puedes eliminar funciones que no necesitas.</li>
    <li><strong>Eliminaci√≥n del retraso t√°ctil (tap delay):</strong> Respuesta instant√°nea en m√≥viles.</li>
  </ul>

  <h4>6. Controles del mapa (Map Controls)</h4>
  <p>Leaflet incluye controles listos para usar:</p>
  <ul>
    <li><strong>Botones de zoom:</strong> + y - para acercar y alejar.</li>
    <li><strong>Atribuci√≥n:</strong> Muestra qui√©n provee los datos del mapa.</li>
    <li><strong>Selector de capas:</strong> Permite cambiar entre diferentes fondos (ej: mapa, sat√©lite).</li>
    <li><strong>Escala:</strong> Muestra una barra de escala en el mapa.</li>
  </ul>

  <h4>7. Compatibilidad (Browser Support)</h4>
  <p>Funciona en todos los navegadores modernos:</p>
  <strong>Escritorio:</strong> Chrome, Firefox, Safari 5+, Opera 12+, IE 9‚Äì11, Edge.<br>
  <strong>M√≥viles:</strong> Safari iOS 7+, Chrome para m√≥vil, Firefox para m√≥vil, IE10+ en Windows 8.

  <h4>8. Miscel√°neos</h4>
  <ul>
    <li><strong>Extremadamente ligero:</strong> ~42 KB en su versi√≥n comprimida.</li>
    <li><strong>Sin dependencias externas:</strong> No necesita jQuery ni otras librer√≠as.</li>
  </ul>

  <h3>¬øQu√© hacer si falta una funci√≥n?</h3>
  <p>Si necesitas una funci√≥n que no est√° en Leaflet:</p>
  <ol>
    <li>Busca un <strong>plugin</strong> en <a href="https://leafletjs.com/plugins.html" target="_blank">Leaflet Plugins</a>.</li>
    <li>Consulta el <strong>FAQ</strong> o los <strong>issues de GitHub</strong>.</li>
    <li>Si no existe, puedes <strong>contribuir</strong> creando un plugin o proponiendo una mejora.</li>
  </ol>

  <h3>¬øC√≥mo contribuir a Leaflet?</h3>
  <p>Leaflet es un proyecto comunitario. Puedes ayudar de muchas formas:</p>
  <ul>
    <li>Reportar errores (bugs).</li>
    <li>Mejorar la documentaci√≥n.</li>
    <li>Ayudar a otros en <strong>Stack Overflow</strong> o <strong>GitHub</strong>.</li>
    <li>Compartir Leaflet en redes sociales.</li>
    <li>Hacer pull requests con mejoras.</li>
  </ul>
  <p>Consulta la <a href="https://github.com/Leaflet/Leaflet/blob/main/CONTRIBUTING.md" target="_blank">gu√≠a de contribuci√≥n</a> para m√°s detalles.</p>
</section>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <!-- Turf.js para operaciones geoespaciales -->
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>

  <!-- Tu JS -->
  <script src="proyectoM.js"></script>
</body>
</html>