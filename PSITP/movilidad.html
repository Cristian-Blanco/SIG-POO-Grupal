<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Movilidad en el Barrio Potos√≠</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <!-- Estilos personalizados -->
  <link rel="stylesheet" href="estilosM.css" />
</head>
<body>
  <!-- Secci√≥n del mapa -->
  <section class="seccion-movilidad">
    <h2>Movilidad en el Barrio Potos√≠, Suba</h2>
    <div class="map-container">
      <div id="map"></div>
    </div>
  </section>

  <!-- Secci√≥n del tutorial -->
  <section class="seccion-tutorial">
    <h2>¬øC√≥mo se construy√≥ este mapa interactivo?</h2>
    <p>Este mapa fue desarrollado utilizando tecnolog√≠as web modernas, siguiendo buenas pr√°cticas de desarrollo cartogr√°fico. A continuaci√≥n, te explicamos paso a paso c√≥mo se hizo, con detalles t√©cnicos y conceptos clave.</p>

    <ol class="tutorial-list">
      <li>
        <strong>1. Descarga de los datos geoespaciales en formato GeoJSON</strong>
        <p>El proyecto comienza con dos archivos clave en formato <strong>GeoJSON</strong>, el est√°ndar abierto para datos geogr√°ficos:</p>
        <ul>
          <li><strong><code>potosi.geojson</code></strong>: Define el pol√≠gono del barrio Potos√≠ en Suba. Este archivo contiene un <code>Polygon</code> o <code>MultiPolygon</code> con coordenadas en <strong>WGS 84 (EPSG:4326)</strong>, el sistema de referencia global que usan Leaflet y OpenStreetMap.</li>
          <li><strong><code>Paraderos_Zonales_del_SITP.geojson</code></strong>: Contiene miles de puntos (<code>Point</code>) que representan los paraderos del SITP en Bogot√°. Se descarg√≥ desde la plataforma oficial: <a href="https://datosabiertos-transmilenio.hub.arcgis.com/datasets/paraderos-zonales-del-sitp/explore" target="_blank">ArcGIS Open Data - TransMilenio</a>.</li>
        </ul>
        <p>‚úÖ Ambos archivos deben estar en la misma carpeta que el proyecto para que <code>fetch()</code> los cargue correctamente.</p>
      </li>

      <li>
        <strong>2. Inicializaci√≥n del mapa con Leaflet</strong>
        <p>Se us√≥ <a href="https://leafletjs.com" target="_blank">Leaflet</a>, la biblioteca JavaScript l√≠der para mapas interactivos, por su simplicidad, rendimiento y compatibilidad con m√≥viles.</p>
        <p>El mapa se inicializa en un elemento HTML con <code>id="map"</code> y se centra en el barrio Potos√≠:</p>
        <pre><code>var map = L.map('map').setView([4.653, -74.085], 14);</code></pre>
        <p>El nivel de zoom <code>14</code> permite ver detalles urbanos como calles y paraderos.</p>
      </li>

      <li>
        <strong>3. Carga de la capa base: OpenStreetMap</strong>
        <p>Leaflet no incluye mapas por defecto. Se a√±ade una capa de teselas (tiles) de <strong>OpenStreetMap</strong>, un mapa base gratuito y de c√≥digo abierto:</p>
        <pre><code>L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);</code></pre>
        <p>Esta capa proporciona el fondo del mapa y es esencial para contextualizar los datos.</p>
      </li>

      <li>
        <strong>4. Dibujar el pol√≠gono del barrio</strong>
        <p>Con <code>fetch()</code>, se carga <code>potosi.geojson</code> y se agrega al mapa como una capa vectorial:</p>
        <pre><code>L.geoJSON(data, {
  style: estiloBarrio,
  onEachFeature: function (feature, layer) {
    layer.bindPopup('<b>Barrio Potos√≠</b><br>Localidad: Suba');
  }
}).addTo(map);</code></pre>
        <p>El estilo define el color naranja del borde y relleno. <code>onEachFeature</code> permite agregar popups a cada elemento.</p>
      </li>

      <li>
        <strong>5. Filtrar paraderos dentro del barrio con Turf.js</strong>
        <p>Leaflet no puede verificar si un punto est√° dentro de un pol√≠gono. Para eso, se usa <a href="https://turfjs.org" target="_blank">Turf.js</a>, una librer√≠a geoespacial potente.</p>
        <p>El c√≥digo convierte el GeoJSON del barrio a un pol√≠gono con <code>turf.polygon()</code> y verifica cada paradero:</p>
        <pre><code>if (turf.booleanPointInPolygon(punto, barrioPolygon)) {
  // Mostrar solo si est√° dentro
}</code></pre>
        <p>Este filtro asegura que solo se muestren los paraderos relevantes.</p>
      </li>

      <li>
        <strong>6. Agregar marcadores interactivos</strong>
        <p>Cada paradero se representa con un marcador usando el emoji üöå, creado con <code>L.divIcon()</code>:</p>
        <pre><code>const iconoParadero = L.divIcon({
  html: 'üöå',
  className: 'paradero-icon',
  iconSize: [30, 30]
});</code></pre>
        <p>Al hacer clic, se abre un popup con informaci√≥n √∫til: nombre, direcci√≥n bandera, c√≥digo cenefa y localidad.</p>
      </li>

      <li>
        <strong>7. Dise√±o y experiencia de usuario</strong>
        <p>El mapa es <strong>mobile-friendly</strong>, con controles t√°ctiles como:</p>
        <ul>
          <li>Arrastre con inercia</li>
          <li>Pinzamiento para zoom</li>
          <li>Desplazamiento con rueda del mouse</li>
        </ul>
        <p>Los estilos CSS personalizados mejoran la presentaci√≥n, y los popups se adaptan a cualquier dispositivo.</p>
      </li>

      <li>
        <strong>8. Ejecuci√≥n local con Live Server</strong>
        <p>Para evitar errores de <em>CORS</em> al cargar archivos locales, se usa un servidor local como <strong>Live Server</strong> (extensi√≥n de VS Code).</p>
        <p>La URL debe ser <code>http://localhost:5500</code>, no <code>file://</code>.</p>
      </li>
    </ol>

    <h3>¬øPor qu√© Leaflet?</h3>
    <p>Leaflet fue elegido porque:</p>
    <ul>
      <li>Es <strong>ligero</strong> (~42 KB) y sin dependencias externas.</li>
      <li>Tiene una <strong>API clara y bien documentada</strong>.</li>
      <li>Soporta <strong>GeoJSON, capas vectoriales y controles personalizados</strong>.</li>
      <li>Es compatible con <strong>m√≥viles y escritorio</strong>.</li>
      <li>Tiene miles de <strong>plugins</strong> para extender funcionalidades.</li>
    </ul>
  </section>

  <!-- Secci√≥n de definiciones basadas en Leaflet -->
  <section class="seccion-definiciones">
    <h2>Conceptos clave en mapas interactivos</h2>

    <h3>¬øQu√© es Leaflet?</h3>
    <p>Seg√∫n su documentaci√≥n oficial, <strong>Leaflet</strong> es la <em>biblioteca JavaScript l√≠der para mapas interactivos m√≥viles y de escritorio</em>. Pesa solo <strong>42 KB</strong> y tiene todas las funciones que la mayor√≠a de desarrolladores necesitan.</p>
    <p>Est√° dise√±ado con <em>simplicidad, rendimiento y usabilidad</em> en mente, y funciona eficientemente en todos los dispositivos principales.</p>

    <h3>Caracter√≠sticas principales de Leaflet</h3>
    <ul>
      <li><strong>Capas por defecto:</strong> Tiles, marcadores, popups, pol√≠gonos, GeoJSON.</li>
      <li><strong>Interacci√≥n:</strong> Arrastre, zoom con rueda, pinch-zoom en m√≥viles, eventos (click, mouseover).</li>
      <li><strong>Dise√±o visual:</strong> Animaciones suaves, dise√±o predeterminado atractivo, soporte para pantallas retina.</li>
      <li><strong>Personalizaci√≥n:</strong> Popups y controles con CSS, marcadores personalizados, proyecciones de mapa (EPSG:3857, 4326, 3395).</li>
      <li><strong>Rendimiento:</strong> Aceleraci√≥n por hardware en m√≥viles, simplificaci√≥n din√°mica de l√≠neas, construcci√≥n modular.</li>
      <li><strong>Controles integrados:</strong> Botones de zoom, atribuci√≥n, selector de capas, escala.</li>
      <li><strong>Compatibilidad:</strong> Chrome, Firefox, Safari, Edge, IE 9+, y navegadores m√≥viles modernos.</li>
    </ul>

    <h3>¬øQu√© es una capa (layer)?</h3>
    <p>Una <strong>capa</strong> es un conjunto de datos geogr√°ficos que se muestra sobre el mapa. En este proyecto usamos:</p>
    <ul>
      <li><strong>Capa base:</strong> OpenStreetMap.</li>
      <li><strong>Capa vectorial:</strong> Pol√≠gono del barrio Potos√≠.</li>
      <li><strong>Capa de marcadores:</strong> Paraderos del SITP.</li>
    </ul>

    <h3>¬øQu√© es un GeoJSON?</h3>
    <p>Es un formato basado en JSON para representar datos geogr√°ficos como <strong>puntos, l√≠neas y pol√≠gonos</strong>. Es el est√°ndar abierto para compartir informaci√≥n espacial en aplicaciones web.</p>

    <h3>¬øQu√© es un popup?</h3>
    <p>Un <strong>popup</strong> es una ventana emergente que muestra informaci√≥n al hacer clic en un marcador o pol√≠gono. En este mapa, muestra el nombre, direcci√≥n bandera y c√≥digo cenefa del paradero.</p>

    <h3>¬øQu√© es Turf.js?</h3>
    <p><strong>Turf.js</strong> es una librer√≠a de an√°lisis geoespacial que permite operaciones como verificar si un punto est√° dentro de un pol√≠gono, calcular distancias o √°reas. Esencial para filtrar datos precisos.</p>

    <h3>Ejemplos de librer√≠as similares</h3>
    <p>Otras librer√≠as populares para mapas web:</p>
    <ul>
      <li><strong><a href="https://openlayers.org" target="_blank">OpenLayers</a>:</strong> M√°s avanzada, ideal para aplicaciones GIS complejas.</li>
      <li><strong><a href="https://deck.gl" target="_blank">deck.gl</a>:</strong> De Uber, para visualizaci√≥n 3D y grandes vol√∫menes de datos.</li>
      <li><strong><a href="https://maplibre.org" target="_blank">MapLibre</a>:</strong> Fork de Mapbox, open-source, con estilos personalizados.</li>
      <li><strong><a href="https://carto.com" target="_blank">CARTO</a>:</strong> Plataforma completa para an√°lisis espacial en la nube.</li>
    </ul>
    <p>Leaflet es ideal para proyectos simples, r√°pidos y m√≥viles.</p>

    <h3>¬øPor qu√© usamos WGS 84 (EPSG:4326)?</h3>
    <p>Es el sistema de coordenadas global que usa GPS. Leaflet y OpenStreetMap lo usan por defecto. Las coordenadas est√°n en <strong>grados de latitud y longitud</strong>, como <code>[4.653, -74.085]</code>. Es fundamental que tus archivos GeoJSON est√©n en este sistema.</p>
  </section>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <!-- Turf.js para operaciones geoespaciales -->
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>

  <!-- Tu JS -->
  <script src="proyectoM.js"></script>
</body>
</html>